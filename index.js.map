{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst searchParams = {\n  key: import.meta.env.VITE_API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: '15',\n};\n\nexport default async function imageAPIRequest(imageName, page = 1) {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      ...searchParams,\n      q: imageName,\n      page,\n    },\n  });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst modalGallery = new SimpleLightbox('.gallery-link', {\n  captionsData: 'data-user',\n  captionDelay: 250,\n});\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n};\n\nexport default function updateImageMarkup(images) {\n  const imagesMarkup = images.map(image => {\n    return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${\n          image.largeImageURL\n        }\"><img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${\n      image.tags\n    }\" width=\"${360}\" height=\"${200}\" data-user=\"${image.user}\"></a>\n        <ul class=\"gallery-image-description-list\">\n            <li class=\"gallery-image-description-item\">\n                <h3 class=\"gallery-image-description-title\">Likes</h3>\n                <p class=\"gallery-image-description-text\">${image.likes}</p>\n            </li>\n            <li class=\"gallery-image-description-item\">\n                <h3 class=\"gallery-image-description-title\">Views</h3>\n                <p class=\"gallery-image-description-text\">${image.views}</p>\n            </li>\n            <li class=\"gallery-image-description-item\">\n                <h3 class=\"gallery-image-description-title\">Comments</h3>\n                <p class=\"gallery-image-description-text\">${image.comments}</p>\n            </li>\n            <li class=\"gallery-image-description-item\">\n                <h3 class=\"gallery-image-description-title\">Downloads</h3>\n                <p class=\"gallery-image-description-text\">${image.downloads}</p>\n            </li>\n        </ul>\n      </li>`;\n  });\n  refs.gallery.insertAdjacentHTML('beforeend', imagesMarkup.join(''));\n  modalGallery.refresh();\n}\n\nexport function clearGallery() {\n  refs.gallery.innerHTML = '';\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport imageAPIRequest from './js/pixabay-api';\nimport imageRender from './js/render-functions';\n\nimport { clearGallery } from './js/render-functions';\n\nconst messageOptions = {\n  class: 'message',\n  titleColor: '#fff',\n  titleSize: '16',\n  titleLineHeight: '1.5',\n  messageColor: '#fff',\n  messageSize: '16',\n  imageWidth: 24,\n  maxWidth: 432,\n  theme: 'dark',\n  close: false,\n  position: 'topRight',\n  timeout: 5000,\n};\nconst errorMessageOptions = {\n  ...messageOptions,\n  backgroundColor: '#ef4040',\n  image: './img/error-message-icon.svg',\n  close: true,\n};\nconst infoMessageOptions = {\n  ...messageOptions,\n  backgroundColor: '#0099FF',\n};\nconst refs = {\n  searchForm: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  galleryLoadBtn: document.querySelector('.gallery-load-btn'),\n  loader: document.querySelector('.loader'),\n};\n\nlet totalPages;\nlet page;\nlet searchText;\n\nrefs.searchForm.addEventListener('submit', searchFormSubmit);\nrefs.galleryLoadBtn.addEventListener('click', loadMore);\n\nasync function searchFormSubmit(event) {\n  event.preventDefault();\n  searchText = event.currentTarget.elements.searchText.value.trim();\n  if (!textValidation(searchText)) {\n    return;\n  }\n  clearGallery();\n  refs.searchForm.reset();\n  const imageData = await galleryLoading();\n  if (!imageData) return;\n  totalPages = Math.ceil(imageData.totalHits / 15);\n  page = 2;\n  if (totalPages <= 1) {\n    showEndOfGalleryMessage();\n    return;\n  }\n  refs.galleryLoadBtn.classList.remove('hidden');\n}\n\nasync function loadMore() {\n  const imageData = await galleryLoading(page);\n  if (!imageData) return;\n  scrollAfterLoad();\n  page++;\n  if (page > totalPages) {\n    page = 2;\n    showEndOfGalleryMessage();\n    return;\n  }\n  refs.galleryLoadBtn.classList.remove('hidden');\n}\nasync function galleryLoading(page = 1) {\n  refs.galleryLoadBtn.classList.add('hidden');\n  refs.loader.classList.remove('hidden');\n  let imageData;\n  try {\n    imageData = await imageAPIRequest(searchText, page);\n    if (imageData.hits.length === 0) {\n      createErrorMessage(\n        '',\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    imageRender(imageData.hits);\n  } catch (error) {\n    createErrorMessage(\n      error.name,\n      `Sorry, the following error occured: ${error.message}`\n    );\n  } finally {\n    refs.loader.classList.add('hidden');\n  }\n  return imageData;\n}\nfunction textValidation(text) {\n  return text !== '';\n}\n\nfunction createErrorMessage(title, message) {\n  iziToast.show({\n    ...errorMessageOptions,\n    title,\n    message,\n  });\n}\n\nfunction scrollAfterLoad() {\n  const galleryItem = refs.gallery.querySelector('.gallery-item');\n  const itemHeight = galleryItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: itemHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showEndOfGalleryMessage() {\n  iziToast.info({\n    ...infoMessageOptions,\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n"],"names":["searchParams","imageAPIRequest","imageName","page","axios","modalGallery","SimpleLightbox","refs","updateImageMarkup","images","imagesMarkup","image","clearGallery","messageOptions","errorMessageOptions","infoMessageOptions","totalPages","searchText","searchFormSubmit","loadMore","event","textValidation","imageData","galleryLoading","showEndOfGalleryMessage","scrollAfterLoad","createErrorMessage","imageRender","error","text","title","message","iziToast","itemHeight"],"mappings":"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"}